# service-weather

Цель:
Разработать микросервис для сбора данных о погоде, их хранения, анализа и автоматизации процессов.  
Стек: Python, PostgreSQL, FastAPI, Apache Airflow.

---

Требования:

1. Работа с PostgreSQL
- Создайте таблицу `weather_data` с полями:  
  `id`, `city` (название города), `date` (дата замера), `temperature` (температура в °C), `humidity` (влажность в %).  
- Используйте SQLAlchemy2 для работы с базой.  
- Настройте Alembic для миграций.

2. Python + Apache Airflow
- Напишите Python-скрипт, который получает текущие погодные данные для трех городов (например, Москва, Лондон, Токио)
  через OpenWeatherMap API(https://openweathermap.org/api) (или любой аналог).  
- Сохраните данные в таблицу `weather_data`.

- Создайте DAG, который:  
  - Ежедневно запускает скрипт сбора данных.  
  - Проверяет, что за последние 24 часа в таблице появились новые записи (в случае отсутствия — отправляет alert в лог).

ВАЖНО: Для работы с базой должен быть использован имеено SQLAlchemy2.

3. FastAPI
- Реализуйте два эндпоинта:
  - `GET /weather` — возвращает данные за указанный диапазон дат и город (параметры: `start_date`, `end_date`, `city`).  
  - `GET /stats` — возвращает среднюю температуру и влажность за период для выбранного города.  
- Добавьте Swagger-документацию.
- Используйте асинхронные запросы к базе данных.
